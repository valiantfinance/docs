# Authentication

üîê

Security is paramount at Valiant so all calls made to our API are authenticated. Once you have been given access to the API, you will receive a Valiant API `uuid`,  `key` and `secret` which are the credentials that allow access to the API. These parameters are used to generate a set of `HTTP` headers that are used to authenticate requests.

The content type of all calls made to the API are also verified. The **`Content-Type`** header in every request must be set to `application/vnd.api+json`.

<aside class="warning">
  ‚ö†Ô∏è Be sure to never expose your API <code>key</code>, <code>secret</code> or <code>signed key</code> in any publicly accessible areas like GitHub, client-side code or website logs!
</aside>

## Headers

We authenticate and verify all API requests via three HTTP headers that are required to be set in all API requests.

| Header                  | Description                                                                                 |
| ----------------------- | ------------------------------------------------------------------------------------------- |
| **`X-AUTH-ID`**         | Your API client `uuid` that is provided once your API account has been established.         |
| **`X-AUTH-SIGNED-KEY`** | A `base64` string generated by `HMAC-SHA256` signing your API `key` with your API `secret`. |
| **`Content-Type`**      | All requests must be set to `application/vnd.api+json`.                                     |

### Generating your signed key

To generate your `signed key` for the **`X-AUTH-SIGNED-KEY`** header you must generate a `base64` string of `HMAC-SHA256` signing your API `key` with your API `secret`.

A great resource that provides examples of generating `base64` hashes using `HMAC-SHA256` in a variety of different languages can be found [here](https://www.jokecamp.com/blog/examples-of-creating-base64-hashes-using-hmac-sha256-in-different-languages/).

### Unauthorized & unverified requests

* Any API requests made without valid authentication headers will fail and return a `401 Unauthorized` status.
* Any API requests made without the correct content type will fail and return a `400 Bad Request` status.

## Testing authentication headers

> Example request

```javascript
xhr = new XMLHttpRequest();

xhr.open("GET", "https://mercury-summer.valiant.finance/api/v1/authenticate");
xhr.setRequestHeader("X-AUTH-ID",         "<API_ID>")
xhr.setRequestHeader("X-AUTH-SIGNED-KEY", "<API_SIGNED_KEY>");
xhr.setRequestHeader("Content-Type",      "application/vnd.api+json");

xhr.onreadystatechange = function () {
  if (xhr.readyState == 4) {
    console.log(xhr.status);
    console.log(xhr.responseText);
  }
}

xhr.send();
```

```shell
curl -iX GET \
  https://mercury-summer.valiant.finance/api/v1/authenticate \
  -H "X-AUTH-ID:         <API_ID>" \
  -H "X-AUTH-SIGNED-KEY: <API_SIGNED_KEY>" \
  -H "Content-Type:      application/vnd.api+json"
```

We have created an API endpoint which an empty request can be sent to in order to check if authentication headers have  been set correctly.

| Item              | Details                |
| ----------------- | ---------------------- |
| Endpoint          | `/api/v1/authenticate` |
| Supported methods | `GET`                  |
| Description       | Test if authentication headers are correctly set. If the authentication & content type headers are set correctly, the endpoint will return a `200 OK` status with an empty body. If authentication headers aren't set correctly the endpoint will return a `401 Unauthorized` header with an empty body. |
